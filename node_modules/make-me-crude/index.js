var Crude = require('./lib/make-me-crude');
var mongoose = require('mongoose');

mongoose.connect('mongodb://localhost/test');
var Post = mongoose.model('Post', {
    hash: String,
    titulo: String,
    texto: String,
    comentarios: Array
});

var PostCRUD = Crude.crud({
    DAO: Post,
    subCrud: {
        comentarios: {
            attribute: 'comentarios'
        }
    }
});

var ComentarioCRUD = PostCRUD.comentarios( '54e653e04a9e7a9c272300ca' );

ComentarioCRUD
    .$where({
        _id: '54e67949ce8821852a626785'
    })
    .$delete()
    .then(function( comentario ){
        console.log( comentario );
    })
    .fail(function( err ){
        console.log( 'ERRO: ' + err );
    })
    .finally(function(){
        mongoose.disconnect();
    });

exports = module.exports = require('./lib/make-me-crude');
